<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2019-05-11T23:50:24+01:00</updated><id>/feed.xml</id><title type="html">Chris Phillips’ Blog</title><subtitle>Father of 2 - IBM Master Inventor &amp; SWAT Integration Architect - API, Integration and Governance SME and Enthusiast, Board Gamer, My opinions are very much mine</subtitle><entry><title type="html">Welcome to Jekyll!</title><link href="/jekyll/update/2019/05/11/welcome-to-jekyll.html" rel="alternate" type="text/html" title="Welcome to Jekyll!" /><published>2019-05-11T21:36:33+01:00</published><updated>2019-05-11T21:36:33+01:00</updated><id>/jekyll/update/2019/05/11/welcome-to-jekyll</id><content type="html" xml:base="/jekyll/update/2019/05/11/welcome-to-jekyll.html">&lt;p&gt;You’ll find this post in your &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt;, which launches a web server and auto-regenerates your site when a file is updated.&lt;/p&gt;

&lt;p&gt;To add new posts, simply add a file in the &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory that follows the convention &lt;code class=&quot;highlighter-rouge&quot;&gt;YYYY-MM-DD-name-of-post.ext&lt;/code&gt; and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works.&lt;/p&gt;

&lt;p&gt;Jekyll also offers powerful support for code snippets:&lt;/p&gt;

&lt;p&gt;def print_hi(name)
  puts “Hi, #”
end
print_hi(‘Tom’)
#=&amp;gt; prints ‘Hi, Tom’ to STDOUT.&lt;/p&gt;

&lt;p&gt;Check out the &lt;a href=&quot;https://jekyllrb.com/docs/home&quot;&gt;Jekyll docs&lt;/a&gt; for more info on how to get the most out of Jekyll. File all bugs/feature requests at &lt;a href=&quot;https://github.com/jekyll/jekyll&quot;&gt;Jekyll’s GitHub repo&lt;/a&gt;. If you have questions, you can ask them on &lt;a href=&quot;https://talk.jekyllrb.com/&quot;&gt;Jekyll Talk&lt;/a&gt;.&lt;/p&gt;</content><author><name></name></author><summary type="html">You’ll find this post in your _posts directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run jekyll serve, which launches a web server and auto-regenerates your site when a file is updated.</summary></entry><entry><title type="html">Quick Note — Egress Whitelisting in Kubernetes</title><link href="/apiconnect/2019/02/03/Quick-Note-Egress-Whitelisting-in-Kubernetes.html" rel="alternate" type="text/html" title="Quick Note --- Egress Whitelisting in Kubernetes" /><published>2019-02-03T00:00:00+00:00</published><updated>2019-02-03T00:00:00+00:00</updated><id>/apiconnect/2019/02/03/Quick-Note-Egress-Whitelisting-in-Kubernetes</id><content type="html" xml:base="/apiconnect/2019/02/03/Quick-Note-Egress-Whitelisting-in-Kubernetes.html">&lt;h1 id=&quot;quick-noteegress-whitelisting-in-kubernetes&quot;&gt;Quick Note — Egress Whitelisting in Kubernetes&lt;/h1&gt;

&lt;p&gt;I got bored flying back from Germany last week and so I tried to solve a
problem our test team were hitting. They needed to whitelist…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;quick-noteegress-whitelisting-in-kubernetes-1&quot;&gt;Quick Note — Egress Whitelisting in Kubernetes&lt;/h3&gt;

&lt;p&gt;I got bored flying back from Germany last week and so I tried to solve a
problem our test team were hitting. They needed to whitelist access to
the internet for all the pods of one application&lt;/p&gt;

&lt;p&gt;I had wanted to play with K8s network policies for ages, finally I got
an excuse.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: foo-deny-external-egress
spec:
  podSelector:
  policyTypes:
  - Egress
  egress:
  - to:
    - ipBlock:
      cidr: &amp;lt;IP to WhiteList&amp;gt;/32
    ports:
      - port: 443
        protocol: TCP
  - ports:
    - port: 53
      protocol: UDP
    - port: 53
      protocol: TCP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/a8815f8afc22&quot;&gt;February 3, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/quick-note-egress-whitelisting-in-kubernetes-a8815f8afc22&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">Quick Note — Egress Whitelisting in Kubernetes</summary></entry><entry><title type="html">API Connect 2018 —  Removing a user from a UserRegistry</title><link href="/apiconnect/2019/01/22/API-Connect-2018-Removing-a-user-from-a-UserRegistry.html" rel="alternate" type="text/html" title="API Connect 2018 ---  Removing a user from a UserRegistry" /><published>2019-01-22T00:00:00+00:00</published><updated>2019-01-22T00:00:00+00:00</updated><id>/apiconnect/2019/01/22/API-Connect-2018-Removing-a-user-from-a-UserRegistry</id><content type="html" xml:base="/apiconnect/2019/01/22/API-Connect-2018-Removing-a-user-from-a-UserRegistry.html">&lt;h1 id=&quot;api-connect-2018-removing-a-user-from-a-userregistry&quot;&gt;API Connect 2018 —  Removing a user from a UserRegistry&lt;/h1&gt;

&lt;p&gt;In API Connect you can create your own user registries, these can be
backed on to LDAP or be a local user registry.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;api-connect-2018removing-a-user-from-a-userregistry&quot;&gt;API Connect 2018 — Removing a user from a UserRegistry&lt;/h3&gt;

&lt;p&gt;In API Connect you can create your own user registries, these can be
backed on to LDAP or be a local user registry.&lt;/p&gt;

&lt;p&gt;There are two ways to delete users from a user registry. Both of these
require that the user is no longer a member to any provider orgs. There
is no way to remove a user from a user registry in the UI today.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;[Delete yourself with the CLI]&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Login as the user you wish to delete&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic login -s &amp;lt;Platform API endpoint&amp;gt; -u &amp;lt;username&amp;gt; --realm &amp;lt;provider|admin&amp;gt;/&amp;lt;user repository&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;run the following command&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic me:delete -s &amp;lt;Platform API endpoint&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic me:delete -s platform.cminion.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2. Delete someone else using the CLI&lt;/p&gt;

&lt;p&gt;Login as an admin to the API Cloud to the admin realm&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic login -s &amp;lt;Platform API endpoint&amp;gt; -u &amp;lt;username&amp;gt; --realm admin/&amp;lt;user repository&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic login —u admin -s platform.cminion.cf  --realm admin/default-idp-1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;List the users. &lt;strong&gt;Please Note: the organisation must be set to admin.&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic users:list -o admin -s &amp;lt;Platform API endpoint&amp;gt; --user-registry &amp;lt;User registry you wish to remove the user from&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic users:list -o admin -s platform.cminion.cf --user-registry test-ldap
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This returns&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hamster                                https://platform.cminion.cf/api/user-registries/4a1d6fb2-3c81-493e-b168-f76fce33cf37/ef389d90-875b-43dd-988e-2487301d2991/users/ac120227-68ce-49e2-be87-634ac70a7ec2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jo                                     https://platform.cminion.cf/api/user-registries/4a1d6fb2-3c81-493e-b168-f76fce33cf37/ef389d90-875b-43dd-988e-2487301d2991/users/fdf0bb82-104b-4576-b988-811a820a188b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rainbowjess11                          https://platform.cminion.cf/api/user-registries/4a1d6fb2-3c81-493e-b168-f76fce33cf37/ef389d90-875b-43dd-988e-2487301d2991/users/1bd06598-4007-4b8c-9417-d790f3df8294
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;val                                    https://platform.cminion.cf/api/user-registries/4a1d6fb2-3c81-493e-b168-f76fce33cf37/ef389d90-875b-43dd-988e-2487301d2991/users/b9bdb3fa-d285-4906-b8a2-a09ccd68069c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Take the GUID for the user which is the string after the last /&lt;/p&gt;

&lt;p&gt;e.g. for jo it is &lt;code class=&quot;highlighter-rouge&quot;&gt;fdf0bb82–104b-4576-b988–811a820a188b&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Run the following command&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic users:delete &amp;lt;guid&amp;gt; -o admin -s &amp;lt;Platform API endpoint&amp;gt; --user-registry &amp;lt;User registry you wish to remove the user from&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apic users:delete fdf0bb82–104b-4576-b988–811a820a188b -o admin -s platform.cminion.cf --user-registry test-ldap
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/3320a4728de5&quot;&gt;January 22, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/api-connect-2018-removing-a-user-from-a-userregistry-3320a4728de5&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">API Connect 2018 —  Removing a user from a UserRegistry</summary></entry><entry><title type="html">API Connect 2018 — CLI Realm changed to identify provider</title><link href="/apiconnect/2019/01/22/API-Connect-2018-CLI-Realm-changed-to-identify-provider.html" rel="alternate" type="text/html" title="API Connect 2018 --- CLI Realm changed to identify provider" /><published>2019-01-22T00:00:00+00:00</published><updated>2019-01-22T00:00:00+00:00</updated><id>/apiconnect/2019/01/22/API-Connect-2018-CLI-Realm-changed-to-identify-provider</id><content type="html" xml:base="/apiconnect/2019/01/22/API-Connect-2018-CLI-Realm-changed-to-identify-provider.html">&lt;h1 id=&quot;api-connect-2018cli-realm-changed-to-identify-provider&quot;&gt;API Connect 2018 — CLI Realm changed to identify provider&lt;/h1&gt;

&lt;p&gt;One of my most viewed posts is…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;api-connect-2018cli-realm-changed-to-identifyprovider&quot;&gt;API Connect 2018 — CLI Realm changed to identify provider&lt;/h3&gt;

&lt;p&gt;One of my most viewed posts is
&lt;a href=&quot;https://medium.com/@cminion/api-connect-2018-cli-login-realm-39f24178bf99?source=your_stories_page---------------------------&quot;&gt;https://medium.com/@cminion/api-connect-2018-cli-login-realm-39f24178bf99?source=your_stories_page---------------------------&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In 2018.4.1.1 the term realm has been replaced with identify provider so
the command is now&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apic identity-providers -s &amp;lt;server&amp;gt; --scope [provder|admin]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/1f3ec710985c&quot;&gt;January 22, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/api-connect-2018-cli-realm-changed-to-identify-provider-1f3ec710985c&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">API Connect 2018 — CLI Realm changed to identify provider</summary></entry><entry><title type="html">APIConnect 2018: Replacing Certificates</title><link href="/apiconnect/2019/01/18/APIConnect-2018-Replacing-Certificates.html" rel="alternate" type="text/html" title="APIConnect 2018: Replacing Certificates" /><published>2019-01-18T00:00:00+00:00</published><updated>2019-01-18T00:00:00+00:00</updated><id>/apiconnect/2019/01/18/APIConnect-2018-Replacing-Certificates</id><content type="html" xml:base="/apiconnect/2019/01/18/APIConnect-2018-Replacing-Certificates.html">&lt;h1 id=&quot;apiconnect-2018-replacing-certificates&quot;&gt;APIConnect 2018: Replacing Certificates&lt;/h1&gt;

&lt;p&gt;This post assumes that you have already generated your certificates. If
you have not read this post…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;apiconnect-2018-replacing-certificates-1&quot;&gt;APIConnect 2018: Replacing Certificates&lt;/h3&gt;

&lt;p&gt;This post assumes that you have already generated your certificates. If
you have not read this post
&lt;a href=&quot;https://medium.com/@cminion/custom-certs-in-api-connect-2018-c7aacecd7b44?source=user_profile---------8------------------&quot;&gt;https://medium.com/@cminion/custom-certs-in-api-connect-2018-c7aacecd7b44?source=user_profile---------8------------------&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Once you have created the certificate you need to run the following
command in your apicup project directory.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apicup certs set &amp;lt;component&amp;gt; cloud-admin-ui &amp;lt;path to cert&amp;gt; &amp;lt;path to priv key&amp;gt; &amp;lt;path to ca/chain&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apicup certs set manager cloud-admi-ui ../cert.pem ../privkey.pem ../chain.pem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once you have done that you need to run&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apicup subsys install manager&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;and the certificates will be replaced.&lt;/p&gt;

&lt;p&gt;To get a list of endpoints you can run&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apicup certs list &amp;lt;component&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/635c94c9b796&quot;&gt;January 18, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/apiconnect-2018-replacing-certificates-635c94c9b796&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">APIConnect 2018: Replacing Certificates</summary></entry><entry><title type="html">QuickNote: Deploying on ICP 3.1.1 and you don’t know what you are doing.</title><link href="/apiconnect/2019/01/11/QuickNote-Deploying-on-ICP-3-1-1-and-you-don-t-know-what-you-are-doing.html" rel="alternate" type="text/html" title="QuickNote: Deploying on ICP 3.1.1 and you don't know what you are doing." /><published>2019-01-11T00:00:00+00:00</published><updated>2019-01-11T00:00:00+00:00</updated><id>/apiconnect/2019/01/11/QuickNote-Deploying-on-ICP-3-1-1-and-you-don-t-know-what-you-are-doing-</id><content type="html" xml:base="/apiconnect/2019/01/11/QuickNote-Deploying-on-ICP-3-1-1-and-you-don-t-know-what-you-are-doing.html">&lt;h1 id=&quot;quicknote-deploying-on-icp-311-and-you-dont-know-what-you-are-doing&quot;&gt;QuickNote: Deploying on ICP 3.1.1 and you don’t know what you are doing.&lt;/h1&gt;

&lt;p&gt;ICP 3.1.1 is locked down.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;quicknote-deploying-on-icp-311-and-you-dont-know-what-you-aredoing&quot;&gt;QuickNote: Deploying on ICP 3.1.1 and you don’t know what you are doing.&lt;/h3&gt;

&lt;p&gt;ICP 3.1.1 is locked down.&lt;/p&gt;

&lt;p&gt;I used the following PSP to remove all the locked down settings. Please
only use this for POC and POTs, and be aware you are weakening your
environment.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apiVersion: extensions/v1beta1
kind: PodSecurityPolicy
metadata:
  annotations
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default
    seccomp.security.alpha.kubernetes.io/defaultProfileName: docker/default
  name: ibm-unrestricted
spec:
  allowPrivilegeEscalation: true
  allowedCapabilities:
  - '*'
  allowedUnsafeSysctls:
  - '*'
  fsGroup:
    rule: RunAsAny
  hostIPC: true
  hostNetwork: true
  hostPID: true
  hostPorts:
  - max: 65535
    min: 0
  privileged: true
  runAsUser:
    rule: RunAsAny
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  volumes:
  - '*'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/ebe860d13eef&quot;&gt;January 11, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/quicknote-deploying-on-icp-3-1-1-and-you-dont-know-what-you-are-doing-ebe860d13eef&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">QuickNote: Deploying on ICP 3.1.1 and you don’t know what you are doing.</summary></entry><entry><title type="html">Roadsweeper — Kubernetes Job Cleaner</title><link href="/apiconnect/2019/01/03/Roadsweeper-Kubernetes-Job-Cleaner.html" rel="alternate" type="text/html" title="Roadsweeper --- Kubernetes Job Cleaner" /><published>2019-01-03T00:00:00+00:00</published><updated>2019-01-03T00:00:00+00:00</updated><id>/apiconnect/2019/01/03/Roadsweeper-Kubernetes-Job-Cleaner</id><content type="html" xml:base="/apiconnect/2019/01/03/Roadsweeper-Kubernetes-Job-Cleaner.html">&lt;h1 id=&quot;roadsweeperkubernetes-job-cleaner&quot;&gt;Roadsweeper — Kubernetes Job Cleaner&lt;/h1&gt;

&lt;p&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;roadsweeperkubernetes-job-cleanerholiday-project-part3&quot;&gt;Roadsweeper — Kubernetes Job Cleaner — &lt;a href=&quot;https://medium.com/p/b0e3d01657f5?source=your_stories_page---------------------------&quot;&gt;Holiday Project Part &lt;/a&gt;3&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My
wife has often questioned “Why do you need any network Infrastructure,
other then a wifi point?”. This article is still&lt;/em&gt; &lt;strong&gt;&lt;em&gt;not&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;going to
address that question.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/800/1*fT5FZirLsGVFYmFQf-PHew.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;One of my projects over xmas was to build my own build engine, im not
happy with it to publish it (yet) but one of the problems it did
highlight was that cronjobs did not nicely clean up completed jobs.&lt;/p&gt;

&lt;p&gt;I created ROADSWEEPER to clean up completed pods and their jobs. This
itself is also a cronjob that runs every five minutes by default.&lt;/p&gt;

&lt;p&gt;Written in nodejs with the kubernetes-client module, every five minutes
it runs a job that polls list of pods in the desired namespace and if
one is in the succeeded phase it deletes the pod and the corresponding
job.&lt;/p&gt;

&lt;p&gt;The code is available here
&lt;a href=&quot;https://github.com/ChrisPhillips-cminion/roadsweeper&quot;&gt;https://github.com/ChrisPhillips-cminion/roadsweeper&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The docker container is published here
&lt;a href=&quot;https://hub.docker.com/r/cminion/roadsweeper&quot;&gt;https://hub.docker.com/r/cminion/roadsweeper&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/790a359dfee2&quot;&gt;January 3, 2019&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/roadsweeper-kubernetes-job-cleaner-790a359dfee2&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">Roadsweeper — Kubernetes Job Cleaner</summary></entry><entry><title type="html">VPNServer running Kubernetes — Holiday Project Part 2</title><link href="/apiconnect/2018/12/27/VPNServer-running-Kubernetes-Holiday-Project-Part-2.html" rel="alternate" type="text/html" title="VPNServer running Kubernetes --- Holiday Project Part 2" /><published>2018-12-27T00:00:00+00:00</published><updated>2018-12-27T00:00:00+00:00</updated><id>/apiconnect/2018/12/27/VPNServer-running-Kubernetes-Holiday-Project-Part-2</id><content type="html" xml:base="/apiconnect/2018/12/27/VPNServer-running-Kubernetes-Holiday-Project-Part-2.html">&lt;h1 id=&quot;vpnserver-running-kubernetesholiday-project-part-2&quot;&gt;VPNServer running Kubernetes — Holiday Project Part 2&lt;/h1&gt;

&lt;p&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;vpnserver-running-kubernetesholiday-project-part2&quot;&gt;VPNServer running Kubernetes&lt;a href=&quot;https://medium.com/p/b0e3d01657f5?source=your_stories_page---------------------------&quot;&gt; — Holiday Project Part &lt;/a&gt;2&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/800/1*EScuR6TCDCBgmvTrClI43g.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My
wife has often questioned “Why do you need any network Infrastructure,
other then a wifi point?”. This article is still&lt;/em&gt; &lt;strong&gt;&lt;em&gt;not&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;going to
address that question.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What is VPN?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;In short by having a VPN Server allows me to connect to my home network
securely from any location. As I travel around the world I find this
useful for backing up files, fixing computer issues and many other
reasons.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;VPN in Kubernetes&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This uses the hwdsl2/ipsec-vpn-server container.&lt;/p&gt;

&lt;p&gt;The helm chart can be downloaded from
&lt;a href=&quot;https://github.com/ChrisPhillips-cminion/vpn-helm&quot;&gt;https://github.com/ChrisPhillips-cminion/vpn-helm&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Update the values.yaml file then run helm install &amp;lt;path to directory&amp;gt;&lt;/p&gt;

&lt;p&gt;The values file must contain these entries&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;VPN_IPSEC_PSK: shared-password
VPN_USER: cminion
VPN_PASSWORD: password
#Public IP
EXTERNALIP: 1.1.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;[VPN_IPSEC_PSK - The share password]&lt;/li&gt;
  &lt;li&gt;[VPN_USER - username]&lt;/li&gt;
  &lt;li&gt;[VPN_PASSWORD - User Password]&lt;/li&gt;
  &lt;li&gt;[ExternalIP: The IP you will be connecting to, for me this is my
houses public IP, it is required to route through
Kubernetes.]&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/76998814705d&quot;&gt;December 27, 2018&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/vpnserver-running-kubernetes-holiday-project-part-2-76998814705d&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">VPNServer running Kubernetes — Holiday Project Part 2</summary></entry><entry><title type="html">PiHole DNS Server running in Kubernetes — Holiday Project Part 1</title><link href="/apiconnect/2018/12/26/PiHole-DNS-Server-running-in-Kubernetes-Holiday-Project-Part-1.html" rel="alternate" type="text/html" title="PiHole DNS Server running in Kubernetes --- Holiday Project Part 1" /><published>2018-12-26T00:00:00+00:00</published><updated>2018-12-26T00:00:00+00:00</updated><id>/apiconnect/2018/12/26/PiHole-DNS-Server-running-in-Kubernetes-Holiday-Project-Part-1</id><content type="html" xml:base="/apiconnect/2018/12/26/PiHole-DNS-Server-running-in-Kubernetes-Holiday-Project-Part-1.html">&lt;h1 id=&quot;pihole-dns-server-running-in-kubernetesholiday-project-part-1&quot;&gt;PiHole DNS Server running in Kubernetes — Holiday Project Part 1&lt;/h1&gt;

&lt;p&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;pihole-dns-server-running-in-kubernetesholiday-project-part1&quot;&gt;PiHole DNS Server running in Kubernetes — Holiday Project Part 1&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/800/1*EScuR6TCDCBgmvTrClI43g.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;During my two weeks off of work I set myself the challenge to move as
much of my home network infrastructure to Kubernetes as possible. My
wife has often questioned “Why do you need any network Infrastructure,
other then a wifi point?”. This article is &lt;strong&gt;not&lt;/strong&gt; going to address that
question.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What is PiHole (&lt;/strong&gt;&lt;a href=&quot;https://pi-hole.net/&quot;&gt;https://pi-hole.net/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/600/1*cvIMIEgd3RWs6aDQnW-VDA.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;PiHole is an awesome DNS Server that includes an AdBlocker. I know
AdBlockers are controversial. I primarily use it to add custom domains
to my network and use the awesome web interface to review what sites my
kids go to. It was originally developed to run on the Raspberry Pi but
has since had a docker release.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PiHole in Kubernetes&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;At this point I am going to assume the readers her know about
Kubernetes. If you do not take a google and a browse.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/600/1*NLJsSiHaSmJE-XhemZo5Ew.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The Helm chart I have published here
&lt;a href=&quot;https://github.com/ChrisPhillips-cminion/pihole-helm&quot;&gt;https://github.com/ChrisPhillips-cminion/pihole-helm&lt;/a&gt; is a very basic
helm chart that deploys a single pod with a single pihole container.&lt;/p&gt;

&lt;p&gt;In the values file, you can specify which domain the ingress should
listen to for the web interface. In addition you can specific any
additional dnsmaq entries. It includes a white list generated from the
scripts at &lt;a href=&quot;https://github.com/anudeepND/whitelist&quot;&gt;https://github.com/anudeepND/whitelist&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I have only used it with Persistent storage but it should work without
it.&lt;/p&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/b0e3d01657f5&quot;&gt;December 26, 2018&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/pihole-dns-server-running-in-kubernetes-holiday-project-part-1-b0e3d01657f5&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">PiHole DNS Server running in Kubernetes — Holiday Project Part 1</summary></entry><entry><title type="html">OpenLDAP with Samba</title><link href="/apiconnect/2018/12/20/OpenLDAP-with-Samba.html" rel="alternate" type="text/html" title="OpenLDAP with Samba" /><published>2018-12-20T00:00:00+00:00</published><updated>2018-12-20T00:00:00+00:00</updated><id>/apiconnect/2018/12/20/OpenLDAP-with-Samba</id><content type="html" xml:base="/apiconnect/2018/12/20/OpenLDAP-with-Samba.html">&lt;h1 id=&quot;openldap-with-samba&quot;&gt;OpenLDAP with Samba&lt;/h1&gt;

&lt;p&gt;So like all good techies I have spent my week off setting up my home
LDAP because I need to ensure my kids (8 and 6) need to learn about…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;openldap-withsamba&quot;&gt;OpenLDAP with Samba&lt;/h3&gt;

&lt;p&gt;So like all good techies I have spent my week off setting up my home
LDAP because I need to ensure my kids (8 and 6) need to learn about
enterprise computing.&lt;/p&gt;

&lt;p&gt;OpenLDAP is an Open Source User Registry. Samba is a file sharing system
that allows you to share files across a network. The aim here is to
allow users to log into the samba service with users from the LDAP.&lt;/p&gt;

&lt;p&gt;LDAP in K8s was a dream. Backing samba (not running in k8s) on to the
LDAP was a challenge.&lt;/p&gt;

&lt;p&gt;This articles assumes you have a working samba not using LDAP and a
working LDAP.&lt;/p&gt;

&lt;p&gt;Add the following config to the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/samba/smb.conf&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[global]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WORKGROUP=WORKGROUP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;passdb backend = ldapsam:ldap://192.168.1.132
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldap suffix = dc=cminion,dc=cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldap admin dn = cn=admin,dc=cminion,dc=cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldap ssl = no
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldap passwd sync = yes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once you have done this you need to run the following to configure the
password for the admin user.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;smbpasswd -w &amp;lt;Password for the admin dn&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;then cycle the SMB service and you should be good to go&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo service smbd restart&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;By &lt;a href=&quot;https://medium.com/@cminion&quot;&gt;Chris Phillips&lt;/a&gt; on
&lt;a href=&quot;https://medium.com/p/bd929f93401a&quot;&gt;December 20, 2018&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/@cminion/openldap-with-samba-bd929f93401a&quot;&gt;Canonical
link&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exported from &lt;a href=&quot;https://medium.com&quot;&gt;Medium&lt;/a&gt; on April 6, 2019.&lt;/p&gt;</content><author><name></name></author><summary type="html">OpenLDAP with Samba</summary></entry></feed>